# 🔧 如何发送命令给机器人

## 📋 当前状态

我们已经有了完整的WebSocket通信系统，包括：
- ✅ WebSocket服务器 (`simple_websocket_server.py`)
- ✅ 机器人客户端 (`robot_test_client.py`)
- ✅ 集成命令发送功能

## 🚀 发送命令的方法

### 方法1: 使用集成命令发送（最简单）

1. **启动WebSocket服务器**
   ```bash
   python3 simple_websocket_server.py
   ```

2. **启动机器人客户端**（同事那边）
   ```bash
   python3 robot_test_client.py
   ```

3. **在服务器端发送命令**
   
   当机器人连接后，服务器会自动显示命令菜单：
   ```
   🤖 已连接的机器人: ['1']
   📋 可用命令:
     - open_door: 开门
     - close_door: 关门
     - start_delivery: 开始配送
     - stop_robot: 停止机器人
     - emergency_open_door: 紧急开门
     - 输入 'help' 查看帮助
     - 输入 'status' 查看机器人状态
     - 输入 'quit' 退出

   请输入命令 (格式: 机器人ID 命令):
   ```

4. **输入命令**
   ```
   1 open_door          # 向机器人1发送开门命令
   1 close_door         # 向机器人1发送关门命令
   1 start_delivery     # 向机器人1发送开始配送命令
   1 stop_robot         # 向机器人1发送停止命令
   1 emergency_open_door # 向机器人1发送紧急开门命令
   ```

### 方法2: 使用独立命令发送脚本

```bash
python3 send_command.py ws://localhost:8001/robot/1 1 open_door
```

### 方法3: 编程方式

```python
import asyncio
import websockets
import json

async def send_command(robot_id, command):
    async with websockets.connect("ws://localhost:8001/robot/1") as websocket:
        message = {
            "type": "command",
            "command": command,
            "target_robot": robot_id
        }
        await websocket.send(json.dumps(message))

# 发送开门命令
asyncio.run(send_command("1", "open_door"))
```

## 📋 可用命令

| 命令 | 描述 | 示例 |
|------|------|------|
| `open_door` | 开门 | 打开机器人舱门 |
| `close_door` | 关门 | 关闭机器人舱门 |
| `start_delivery` | 开始配送 | 开始配送任务 |
| `stop_robot` | 停止机器人 | 停止机器人移动 |
| `emergency_open_door` | 紧急开门 | 紧急情况下开门 |

## 🧪 测试流程

### 完整测试示例

1. **启动服务器**
   ```bash
   python3 simple_websocket_server.py
   ```

2. **启动客户端**（同事那边）
   ```bash
   python3 robot_test_client.py
   ```

3. **发送测试命令**
   ```
   1 open_door          # 测试开门
   1 close_door         # 测试关门
   1 start_delivery     # 测试开始配送
   1 stop_robot         # 测试停止
   ```

4. **观察结果**
   - 服务器端显示：`✅ 命令已发送: open_door -> 机器人 1`
   - 客户端显示：`🔧 收到命令: open_door` 和 `🔧 发送命令结果: success - 门已打开`

## 🔍 查看状态

### 查看机器人状态
```
status
```

### 查看帮助
```
help
```

### 退出
```
quit
```

## ❗ 注意事项

1. **确保机器人已连接**
   - 机器人客户端必须正在运行
   - 检查网络连接是否正常

2. **命令格式**
   - 格式：`机器人ID 命令`
   - 示例：`1 open_door`

3. **网络配置**
   - 确保端口8001可访问
   - 检查防火墙设置

## 🔄 故障排除

### 常见问题

1. **机器人未连接**
   - 检查客户端是否启动
   - 确认网络连接

2. **命令发送失败**
   - 检查命令格式
   - 确认机器人ID正确

3. **无响应**
   - 检查WebSocket连接
   - 查看服务器日志

## 📞 快速开始

**最简单的使用方式**：

1. 启动服务器：`python3 simple_websocket_server.py`
2. 同事启动客户端：`python3 robot_test_client.py`
3. 在服务器端输入：`1 open_door`
4. 观察客户端响应

---

**总结**: 最简单的方法是使用WebSocket服务器内置的命令发送功能，直接在服务器端输入命令即可。 