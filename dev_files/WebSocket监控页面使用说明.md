# 🔌 WebSocket实时监控页面使用说明

## 🎯 功能概述

我已经为你创建了一个专业的WebSocket实时监控页面，可以实时查看所有WebSocket连接、日志和统计信息。

## 📍 访问地址

**WebSocket监控页面**: http://localhost:3000/superuser/websocket-monitor

## 🔐 登录信息

- **用户名**: `root`
- **密码**: `test123456`
- **权限**: 超级管理员

## 🎨 页面功能

### 1. 连接状态监控
- **实时连接状态**: 显示WebSocket监控连接是否正常
- **自动重连**: 连接断开时自动重连

### 2. 统计信息面板
- **总连接数**: 所有WebSocket连接的总数
- **活跃连接**: 当前活跃的连接数
- **消息总数**: 所有WebSocket消息的总数
- **错误数**: WebSocket错误的总数

### 3. 机器人连接状态
- **实时状态**: 显示每个机器人的连接状态
- **详细信息**: 包括电量、门状态、位置等
- **状态颜色**: 
  - 🟢 绿色: 已连接
  - 🟡 黄色: 连接中
  - 🔴 红色: 已断开

### 4. 日志监控
- **实时日志**: 显示所有WebSocket相关日志
- **日志级别**: DEBUG、INFO、WARNING、ERROR
- **过滤功能**: 按机器人ID、事件类型、日志级别过滤
- **自动滚动**: 新日志自动滚动到底部

### 5. 操作功能
- **清空日志**: 清除当前显示的日志
- **导出日志**: 下载日志文件
- **自动滚动**: 开启/关闭自动滚动

## 🔧 技术特性

### 前端特性
- **React + TypeScript**: 现代化的前端框架
- **实时WebSocket**: 与后端实时通信
- **响应式设计**: 支持移动端和桌面端
- **美观界面**: 现代化的UI设计

### 后端特性
- **Django Channels**: 支持WebSocket通信
- **JWT认证**: 安全的用户认证
- **权限控制**: 只有超级管理员可访问
- **实时日志**: 从数据库实时获取日志

## 📊 日志类型

### 连接日志
- `WEBSOCKET_CONNECTION`: 连接建立和断开
- `WEBSOCKET_MESSAGE`: 消息收发
- `WEBSOCKET_ERROR`: 错误信息

### 日志级别
- **DEBUG**: 调试信息
- **INFO**: 一般信息
- **WARNING**: 警告信息
- **ERROR**: 错误信息

## 🚀 使用步骤

### 1. 登录系统
1. 访问 http://localhost:3000
2. 使用 `root` / `test123456` 登录
3. 进入超级管理员页面

### 2. 访问监控页面
1. 点击 "WebSocket监控" 或直接访问
2. 页面会自动连接WebSocket监控服务
3. 查看实时统计信息和日志

### 3. 监控机器人连接
1. 当同事的机器人连接时，会在"机器人连接状态"区域显示
2. 可以实时查看机器人的状态信息
3. 日志区域会显示所有WebSocket活动

## 🔍 故障排除

### 常见问题

1. **页面无法访问**
   - 检查Docker服务是否正常运行
   - 确认端口3000是否被占用

2. **WebSocket连接失败**
   - 检查后端服务是否正常
   - 确认ASGI配置是否正确

3. **没有日志显示**
   - 确认是否有WebSocket活动
   - 检查数据库中的日志记录

4. **权限不足**
   - 确认使用超级管理员账户登录
   - 检查用户权限设置

### 调试方法

1. **查看浏览器控制台**
   - 按F12打开开发者工具
   - 查看Console标签页的错误信息

2. **查看Docker日志**
   ```bash
   docker-compose logs backend
   docker-compose logs frontend
   ```

3. **检查网络连接**
   ```bash
   curl http://localhost:3000
   curl http://localhost:8000/api/token/
   ```

## 📈 扩展功能

### 未来可以添加的功能
- **实时图表**: 显示连接数和消息数的趋势图
- **告警系统**: 当出现错误时发送通知
- **日志搜索**: 支持关键词搜索日志
- **性能监控**: 显示WebSocket性能指标
- **用户管理**: 管理监控页面的访问权限

## 🎉 总结

这个WebSocket监控页面提供了：

✅ **实时监控**: 所有WebSocket连接和活动  
✅ **可视化界面**: 直观的统计信息和状态显示  
✅ **日志管理**: 完整的日志查看和导出功能  
✅ **权限控制**: 安全的访问控制  
✅ **响应式设计**: 支持各种设备访问  

现在你可以实时监控同事的机器人连接状态和所有WebSocket活动了！ 